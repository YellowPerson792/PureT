[INFO: 2025-09-09 17:27:21,008] Training with config:
[INFO: 2025-09-09 17:27:21,009] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': '',
            'GT_PATH': '',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 17:28:48,703] Training with config:
[INFO: 2025-09-09 17:28:48,704] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': '',
            'GT_PATH': '',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 17:35:35,244] Training with config:
[INFO: 2025-09-09 17:35:35,246] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': '',
            'GT_PATH': '',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 17:37:42,431] ######## Step 50 (VAL) ########
[INFO: 2025-09-09 17:37:42,433] {'Bleu_1': 2.8352693564790217e-05, 'Bleu_2': 2.928253599953879e-08, 'Bleu_3': 2.9599211354423034e-09, 'Bleu_4': 9.410568640393239e-10, 'ROUGE_L': 0.12229196430401373, 'CIDEr': 0.003746407831332245, 'METEOR': 0.013764624913971095}
[INFO: 2025-09-09 17:39:14,513] ######## Step 100 (VAL) ########
[INFO: 2025-09-09 17:39:14,513] {'Bleu_1': 0.0017628525858772385, 'Bleu_2': 1.7992038863284489e-06, 'Bleu_3': 1.811486805255461e-07, 'Bleu_4': 5.7479445815420236e-08, 'ROUGE_L': 0.1928138973082368, 'CIDEr': 0.006424366770683618, 'METEOR': 0.025528520143597924}
[INFO: 2025-09-09 17:40:50,085] ######## Step 150 (VAL) ########
[INFO: 2025-09-09 17:40:50,085] {'Bleu_1': 0.15911484641898962, 'Bleu_2': 0.08397435532974368, 'Bleu_3': 3.1691902647654997e-07, 'Bleu_4': 6.691443714797034e-10, 'ROUGE_L': 0.23764748496517835, 'CIDEr': 0.018259933870303557, 'METEOR': 0.05186020247624154}
[INFO: 2025-09-09 17:42:25,195] ######## Step 200 (VAL) ########
[INFO: 2025-09-09 17:42:25,195] {'Bleu_1': 0.42222783247423545, 'Bleu_2': 0.20478340452783828, 'Bleu_3': 0.05506110591775902, 'Bleu_4': 5.516484497045962e-06, 'ROUGE_L': 0.33520210920555693, 'CIDEr': 0.042885525375322114, 'METEOR': 0.07592624247777913}
[INFO: 2025-09-09 17:44:00,107] ######## Step 250 (VAL) ########
[INFO: 2025-09-09 17:44:00,107] {'Bleu_1': 0.4029723879949315, 'Bleu_2': 0.2112783403599136, 'Bleu_3': 0.09696694247910397, 'Bleu_4': 8.512511612297985e-06, 'ROUGE_L': 0.3030717245364514, 'CIDEr': 0.07717521904785488, 'METEOR': 0.07531585641316647}
[INFO: 2025-09-09 17:45:34,131] ######## Step 300 (VAL) ########
[INFO: 2025-09-09 17:45:34,131] {'Bleu_1': 0.45104395758147836, 'Bleu_2': 0.22479854092016607, 'Bleu_3': 0.08861739034437462, 'Bleu_4': 7.393992160304487e-06, 'ROUGE_L': 0.31432738536260757, 'CIDEr': 0.07453453416767457, 'METEOR': 0.08535118747655039}
[INFO: 2025-09-09 17:47:08,604] ######## Step 350 (VAL) ########
[INFO: 2025-09-09 17:47:08,605] {'Bleu_1': 0.45532919232094426, 'Bleu_2': 0.25053300671440903, 'Bleu_3': 0.1503563321739001, 'Bleu_4': 0.08087077411132543, 'ROUGE_L': 0.32261004410794336, 'CIDEr': 0.12613990936691147, 'METEOR': 0.10863230828269742}
[INFO: 2025-09-09 17:48:45,017] ######## Step 400 (VAL) ########
[INFO: 2025-09-09 17:48:45,017] {'Bleu_1': 0.42616356978902753, 'Bleu_2': 0.2428354407830733, 'Bleu_3': 0.12874220556250413, 'Bleu_4': 9.133871380331515e-06, 'ROUGE_L': 0.32185994577658955, 'CIDEr': 0.12137983251914931, 'METEOR': 0.10531623713647124}
[INFO: 2025-09-09 17:50:21,304] ######## Step 450 (VAL) ########
[INFO: 2025-09-09 17:50:21,305] {'Bleu_1': 0.39115044247718384, 'Bleu_2': 0.18893709230154623, 'Bleu_3': 0.0813004932801638, 'Bleu_4': 5.998709920733145e-06, 'ROUGE_L': 0.3002596060597719, 'CIDEr': 0.0848353633369216, 'METEOR': 0.1031407800956615}
[INFO: 2025-09-09 17:51:57,572] ######## Step 500 (VAL) ########
[INFO: 2025-09-09 17:51:57,572] {'Bleu_1': 0.3650519031135553, 'Bleu_2': 0.17040604321970507, 'Bleu_3': 0.06722085480572515, 'Bleu_4': 5.161394810974139e-06, 'ROUGE_L': 0.2849642651872455, 'CIDEr': 0.07944407717711244, 'METEOR': 0.10619391534826197}
[INFO: 2025-09-09 17:53:33,478] ######## Step 550 (VAL) ########
[INFO: 2025-09-09 17:53:33,478] {'Bleu_1': 0.3864915572225394, 'Bleu_2': 0.19393016602599256, 'Bleu_3': 0.09849144498603161, 'Bleu_4': 0.047261411414285796, 'ROUGE_L': 0.28336898477017486, 'CIDEr': 0.0896782090791382, 'METEOR': 0.10240706465650921}
[INFO: 2025-09-09 17:55:09,022] ######## Step 600 (VAL) ########
[INFO: 2025-09-09 17:55:09,022] {'Bleu_1': 0.37860780984655584, 'Bleu_2': 0.1797543120876864, 'Bleu_3': 0.07346272073717815, 'Bleu_4': 5.481938088673781e-06, 'ROUGE_L': 0.2896037089189097, 'CIDEr': 0.07860389807532, 'METEOR': 0.10849436268428364}
[INFO: 2025-09-09 17:56:44,562] ######## Step 650 (VAL) ########
[INFO: 2025-09-09 17:56:44,562] {'Bleu_1': 0.3618090452255246, 'Bleu_2': 0.18002967059958289, 'Bleu_3': 0.09926763641346874, 'Bleu_4': 0.057513709742161495, 'ROUGE_L': 0.28046684092297464, 'CIDEr': 0.09501924376883053, 'METEOR': 0.10335323585857158}
[INFO: 2025-09-09 17:58:20,725] ######## Step 700 (VAL) ########
[INFO: 2025-09-09 17:58:20,725] {'Bleu_1': 0.3613595706612498, 'Bleu_2': 0.15763219090424047, 'Bleu_3': 0.06468680694442448, 'Bleu_4': 0.0339186421103733, 'ROUGE_L': 0.2712538984567738, 'CIDEr': 0.07014173465765793, 'METEOR': 0.09546944148087581}
[INFO: 2025-09-09 18:00:02,389] ######## Step 750 (VAL) ########
[INFO: 2025-09-09 18:00:02,389] {'Bleu_1': 0.38305709023870527, 'Bleu_2': 0.17183043571797446, 'Bleu_3': 0.0810890379311518, 'Bleu_4': 0.04058644120749988, 'ROUGE_L': 0.28439730938153734, 'CIDEr': 0.08528329859745662, 'METEOR': 0.10171811150883087}
[INFO: 2025-09-09 18:01:40,529] ######## Step 800 (VAL) ########
[INFO: 2025-09-09 18:01:40,529] {'Bleu_1': 0.3771331058014042, 'Bleu_2': 0.17595081071029411, 'Bleu_3': 0.08604297639373497, 'Bleu_4': 0.04575570593248349, 'ROUGE_L': 0.28804398614229143, 'CIDEr': 0.09529712415412905, 'METEOR': 0.10034432250097099}
[INFO: 2025-09-09 18:03:16,669] ######## Step 850 (VAL) ########
[INFO: 2025-09-09 18:03:16,669] {'Bleu_1': 0.3673835125441445, 'Bleu_2': 0.16577528118411758, 'Bleu_3': 0.08143395467965787, 'Bleu_4': 0.04463950985570199, 'ROUGE_L': 0.28215049416628796, 'CIDEr': 0.08733818719439239, 'METEOR': 0.10003304324317365}
[INFO: 2025-09-09 18:04:53,676] ######## Step 900 (VAL) ########
[INFO: 2025-09-09 18:04:53,676] {'Bleu_1': 0.3796296296289266, 'Bleu_2': 0.17158282301802902, 'Bleu_3': 0.08444601309151212, 'Bleu_4': 0.04192042817233978, 'ROUGE_L': 0.2797790345600077, 'CIDEr': 0.0905911960179962, 'METEOR': 0.10331838221005248}
[INFO: 2025-09-09 18:06:32,194] ######## Step 950 (VAL) ########
[INFO: 2025-09-09 18:06:32,195] {'Bleu_1': 0.3785310734456148, 'Bleu_2': 0.18395536472830437, 'Bleu_3': 0.09803390383519921, 'Bleu_4': 0.06206386127656013, 'ROUGE_L': 0.2810095009443066, 'CIDEr': 0.09349764697932894, 'METEOR': 0.09898439645816208}
[INFO: 2025-09-09 18:08:09,972] ######## Step 1000 (VAL) ########
[INFO: 2025-09-09 18:08:09,973] {'Bleu_1': 0.3608058608052, 'Bleu_2': 0.16843341612665108, 'Bleu_3': 0.08303376327701115, 'Bleu_4': 0.04123583029362011, 'ROUGE_L': 0.27718108253014373, 'CIDEr': 0.08954327434136303, 'METEOR': 0.09921100842784752}
[INFO: 2025-09-09 18:09:45,288] ######## Step 1050 (VAL) ########
[INFO: 2025-09-09 18:09:45,288] {'Bleu_1': 0.35081374321817216, 'Bleu_2': 0.16702608532300578, 'Bleu_3': 0.09739138769387806, 'Bleu_4': 0.060897850899946926, 'ROUGE_L': 0.2676292975096825, 'CIDEr': 0.09249042927211151, 'METEOR': 0.09711343547978683}
[INFO: 2025-09-09 18:10:48,086] Training with config:
[INFO: 2025-09-09 18:10:48,087] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': 'coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': 'coco_train_target.pkl',
                 'TEST_4W_ID': 'coco_test4w_image_id.txt',
                 'TEST_ATT_FEATS': 'up_down_10_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': 'coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': 'up_down_10_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': 'coco_train_image_id.txt',
                 'VAL_ATT_FEATS': 'up_down_10_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': 'coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': 'captions_test5k.json',
               'VAL_ANNFILE': 'captions_val5k.json',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:19:42,905] Training with config:
[INFO: 2025-09-09 18:19:42,906] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': 'coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': 'coco_train_target.pkl',
                 'TEST_4W_ID': 'coco_test4w_image_id.txt',
                 'TEST_ATT_FEATS': 'up_down_10_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': 'coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': 'up_down_10_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': 'coco_train_image_id.txt',
                 'VAL_ATT_FEATS': 'up_down_10_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': 'coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': 'captions_test5k.json',
               'VAL_ANNFILE': 'captions_val5k.json',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:20:04,555] Training with config:
[INFO: 2025-09-09 18:20:04,556] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': 'coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': 'coco_train_target.pkl',
                 'TEST_4W_ID': 'coco_test4w_image_id.txt',
                 'TEST_ATT_FEATS': 'up_down_10_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': 'coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': 'up_down_10_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': 'coco_train_image_id.txt',
                 'VAL_ATT_FEATS': 'up_down_10_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': 'coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': 'captions_test5k.json',
               'VAL_ANNFILE': 'captions_val5k.json',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:25:45,278] Training with config:
[INFO: 2025-09-09 18:25:45,278] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:30:44,842] Training with config:
[INFO: 2025-09-09 18:30:44,843] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:32:00,277] Training with config:
[INFO: 2025-09-09 18:32:00,278] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': '',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': '',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': '',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': ''},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K_HF',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '',
               'VAL_ANNFILE': '',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-09-09 18:58:45,482] Training with config:
[INFO: 2025-09-09 18:58:45,482] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './data/flickr8k/test_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './data/flickr8k/test_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './data/flickr8k/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './data/flickr8k/val_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'FLICKR8K',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './data/flickr8k/captions_test.json',
               'VAL_ANNFILE': './data/flickr8k/captions_val.json',
               'VOCAB': './data/flickr8k/flickr8k_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 1536,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT',
           'VOCAB_SIZE': 7375,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments_PureT/PureT_XE/',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 0.01,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 100},
            'MAX_EPOCH': 20,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
